# Geometric-Tm
Protein dynamics-informed multigraphic neural network for melting temperature prediction.

---
# Overview
## Code for data processing and training
The program is written as a Python package located under `/src/ml_modules`.
Code for building the data representation can be found under `data`, while the model architecture and code for training / testing loop can be found under `training`.
Actual runs are built upon these modules and are located under `/experiments` and are grouped hierarchically into subdirectories in the following order: (1) dataset for training, (2) model architecture, and (3) data representation. For example, to find training scripts for the S1 architecture on the full training set, go to `/experiments/full dataset (19,939 entries)/S1`.

## Dataset
The list of proteins in each dataset are listed under `/src/datasets`. Here, you'll find three sets:
1. Preliminary training set: used to quickly screen all setups.
2. Full training set: a selection of best-performing setups is trained on this set.
3. Test set: all evaluations are completed on this set.

Additionally, statistics on the dynamical coupling values are summed up in the subdirectory. These values are referenced when the selected data representation calls for threshold vallues that are determined based on dataset-wide statistics.

## Data
Data downloaded or generated are all saved under `/data`. These are categorized into three:
1. `external`: Structures downloaded from AlphaFoldDB will be saved here. A log for entries that failed to download are also kept here.
2. `collation`: Files generated by `TNM` will be merged into one and saved here. A log for entries that failed to be processed are also kept here.
3. `processed`: Graph generated will be saved in here. The sequence embeddings from ProtTrans and the edge connection are saved in separate files.

## Generating the figures
Code for data analysis and plotting are placed under `notebooks`.

---
# Environment setup
1. The conda environment used is provided in `environment.yml`. Run the following to create it:
```
conda env create -f environment.yml
conda activate Geometric-Tm # enter the environment
pip install torch==2.8.0 --index-url https://download.pytorch.org/whl/cu128
pip install torch_geometric
```
2. You'll also need to build [TNM]([url](https://github.com/ugobas/tnm)) (commit: 66d3ace) and place it in your PATH. (The original character length of 80 for arguments is likely too short for the absolute path that our application sents to it, so be sure to modify `main_tnm.c` before building. In particular, look for `char input [80]=""` and make the array larger, e.g., to 512.)
